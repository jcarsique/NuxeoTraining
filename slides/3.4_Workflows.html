<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<title>Nuxeo Training - Custom Operations</title>

<meta name="description" content="Nuxeo Training - Custom Operations">
<meta name="author" content="Nuxeo">
<meta name="viewport" content="width=1024, user-scalable=no">

<!-- Core and extension CSS files -->
<link rel="stylesheet" href="deck.js/core/deck.core.css">
<link rel="stylesheet" href="deck.js/extensions/goto/deck.goto.css">
<link rel="stylesheet" href="deck.js/extensions/menu/deck.menu.css">
<link rel="stylesheet"
  href="deck.js/extensions/navigation/deck.navigation.css">
<link rel="stylesheet" href="deck.js/extensions/status/deck.status.css">
<link rel="stylesheet" href="deck.js/extensions/hash/deck.hash.css">
<link rel="stylesheet" href="deck.js/extensions/scale/deck.scale.css">

<!-- Nuxeo Slide Default theme -->
<link rel="stylesheet"
  href="nuxeo-slide-template/themes/style/nuxeo-theme.css">

<!-- Nuxeo Slide with comments theme -->
<link rel="stylesheet alternate" title="with comments"
  href="nuxeo-slide-template/themes/style/nuxeo-theme-with-comments.css">

<!-- Transition theme. More available in /themes/transition/ or create your own. -->
<link rel="stylesheet"
  href="nuxeo-slide-template/themes/transition/nuxeo-transition.css">

<script src="deck.js/modernizr.custom.js"></script>
</head>

<body class="deck-container">

  <!-- Nuxeo Logo Training -->
  <div class="nuxeo-logo">
    <span class="nuxeo">nuxeo</span> <span class="slash">/</span> <span
      class="sub-part training">Trainings</span>
  </div>


<section class="slide" id="nuxeo-training---custom-operations">
Nuxeo Training - Workflows
------------------------------------

######Sun Seng David TAN - Alain Escaffre http://doc.nuxeo.com/x/mYSo
</section>


<section class="slide no-md" id="longtimeago">
<h3>Workflows in Nuxeo, A long time ago ...</h3>
<p>Not our first try !</p>
<ul>
      <li class="slide">Jbpm</li>
      <li class="slide">Old Content routing used in CMF</li>
      <li class="slide">Users action + automation + lifecycle + tasks</li>
</ul>
</section>


<section class="slide no-md" id="whatwasfailing">
<h3>What was failing ?</h3>
   <ul>
      <li class="slide">Jbpm
        <ul>
          <li>Too complex workflow engine for simple use case</li>
          <li>One more technology to learn</li>
        </ul>
      </li>
      <li class="slide">Old Content routing
        <ul>
          <li>Linear route, can't go back</li>
        </ul>
      </li>
      <li class="slide">Users action + automation + lifecycle + tasks
        <ul>
          <li>No global overview</li>
        </ul>
      </li>
   </ul>
</section>


<section class="slide no-md" id="newwfengine">
<div class="sticker">Available since Nuxeo 5.6</div>
<h3>New WF engine</h3>
<p>Based on existing infrastructure</p>
<ul>
      <li>Automation<div class="further-info">Powered by Content Automation</div></li>
      <li>Layout <div class="further-info">Dynamic forms using the layout system</div></li>
      <li>Notification <div class="further-info">Workflow notifications – using the  freemarker templating  system</div></li>
      <li>Document <div class="further-info">Stored as a structure of documents</div></li>
      <li>Content views</li>
      <li>Lifecycle</li>
      <li>Task</li>
      <li class="slide">A Studio graph editor</li>
</ul>
</section>



<section class="slide">
##Demo1 - default serial workflow
</section>


<section class="slide">
##Demo2 - holiday management
</section>


<section class="slide" id="customization-cycle">
###Customization cycle
####Step 1:  Workflow feature configuration in Nuxeo Studio
 - Creation of a new workflow feature
 - Graph design
 - Nodes configuration <div class="further-info">including forms and automation chains if required</div>
 
####Step 2: Deployment on a Nuxeo instance of the Studio plugin.
=> a workflow template ( model ) . Using this template we start a workflow instance on a document.

Start the workflow from the UI using “Workflow Process” widget or using the StartWorkflow operation.
</section>


<section class="slide" id="graph-editor">
###Graph editor
![a screen shot of the graph editor in studio](img/workflow-graph-editor.png)
</section>


<section class="slide" id="templates">
###Workflow templates and instances
Studio generates workflow configurations

- As xml
- At startup, generates documents (templates) -> availables  workflows

When starting a WF

- New instance created as documents
- Copy of the template
- Can restrict access with ACL
</section>


<section class="slide" id="innuxeo">
###Workflow management in Nuxeo UI
####Summary tab of a doc
  - choose a workflow and start it <img alt="workflow-summary-availables" src="img/workflow-summary-availables.png" class="float-right" />
  - currently started workflows
  - Waiting task for this doc + layout + actions

####Dashboard
<img alt="workflow-dashboard" src="img/workflow-dashboard.png" class="float-right" />

  - Waiting tasks for the user + link to the doc

####Admin Center
  - Workflow templates availables

 ![workflow-summary-task](img/workflow-summary-task.png)
</section>


<section class="slide" id="concepts">
##Nuxeo Workflow Concepts
 </section>


<section class="slide" id="workflow-definition">
###Workflow definition
<img alt="workflow-definition" src="img/workflow-definition.png" class="float-right" />

- Feature id
- Label
- icons
</section>
 
 <section class="slide" id="enablements">
###Availability
<img alt="workflow-availability" src="img/workflow-availability.png" class="float-right" />

Like actions, event handlers, tabs, etc ... 

A workflow can be enabled according to

- doctypes
- the current lifecycle state
- the permission
- etc ...

![Available workflow to start in the summary tab](img/workflow-summary-availables.png)
</section>
 
 <section class="slide" id="Nodes">
###Nodes
<img alt="workflow-graph-node" src="img/workflow-graph-node.png" class="float-right" />

Node: square, a step of the workflow

- Node
- Start node
- End node
- Fork 2 ways
- Fork 3 ways
- A node has transitions

Available nodes are only examples/samples
</section>

<section class="slide" id="editnode">
###Node edition
<img alt="Studio node edition form" src="img/workflow-node-definition.png" class="float-right" />

 - Label
 - incoming and outcoming chains to execute

</section>

<section class="slide" id="Transition">
###Transitions

<img alt="workflow-transition-arrow" src="img/workflow-transition-arrow.png" class="float-right" />

 - Next routes that can take a workflow
 - From one node to another
 - point > arrow.
 - Can execute automation chains
 - Condition to follow the transition (or not)
 - Parallel: will follow the all *true* transitions
 
 <img alt="workflow-node-transitions" src="img/workflow-node-transitions.png" />
 </section>
 
<section class="slide exercise" id="workshop-nodes-transition">
<img src="nuxeo-slide-template/themes/exercise.svg" alt="exercise"
      class="exercise-icon">
###Exercise: Nodes and transitions
- Create a simple workflow having only the Start and the Stop nodes
- Make sure this workflow can be started only on documents of type File and only if the user has the Read and Write permissions on the current document
- After deploying the workflow in Nuxeo go to the Workflow tab in Admin Center and check that your workflow model is there
- Start the workflow from a file, the workflow should do nothing
</section>
 
 <section class="slide" id="Task">
###A special Node: Task
- has assignees
- wait for the assignee action before going into the transition
- can set a form to be filled by the assignee
- can bind actions and choose the transition to take
- the form set values to
  - workflow variables
  - task variables
</section>

<section class="slide" id="workflow-variables">
###Workflow variables
- variable accessible for the whole instance of the workflow
- accessible in automation
- accessible in the task layouts
</section>

<section class="slide" id="nodevariable">
###Node variables
- variable accessible for a instance of a node
- accessible in automation
- accessible in the task layouts
</section>

<section class="slide" id="assignees">
###Task - Assignment
#### to a static group
- See "group:…" notation 
- Ex: assignment to hr_manager group in the workflow

#### To the workflow initiator
- *workflowInitiator* variable
- See also *lastNodeActor*

#### To a computed variable
- Use input chain to set a Node variable
- Leverage vocabulary tables to provide a quick mapping interface between some users and some others (Jack is John's manager)
</section>

<section class="slide" id="notification">
### Notifications
#### Built-in 
- Notification configuration to assignee, with template choice
- Ability to leverage the workflow variables in the freemarker template

#### Custom
- Sending a custom email in output chain or input chain, using *Send Email* operation
- Also uses freemarker templates --> easy to maintain
</section>

  <section class="slide" id="workshop">
##Workshop - workflow
  </section>


  <section class="slide" id="end">
##Thank you
  </section>

  <!-- deck.navigation snippet -->
  <a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
  <a href="#" class="deck-next-link" title="Next">&#8594;</a>

  <!-- deck.status snippet -->
  <p class="deck-status">
    <span class="deck-status-current"></span> / <span
      class="deck-status-total"></span>
  </p>

  <!-- deck.goto snippet -->
  <form action="." method="get" class="goto-form">
    <label for="goto-slide">Go to slide:</label> <input type="text"
      name="slidenum" id="goto-slide" list="goto-datalist">
    <datalist id="goto-datalist"></datalist>
    <input type="submit" value="Go">
  </form>

  <!-- deck.hash snippet -->
  <a href="." title="Permalink to this slide" class="deck-permalink">#</a>

  <!-- Grab CDN jQuery, with a protocol relative URL; fall back to local if offline -->
  <script
    src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <!-- script>window.jQuery || document.write('<script src="deck.js/jquery-1.7.2.min.js"><\/script>')</script -->
  <script>window.jQuery || document.write('<script src="deck.js/jquery-1.7.2.min.js"><\/script>')</script>


  <!-- Deck Core and extensions -->
  <script src="deck.js/core/deck.core.js"></script>
  <script src="deck.js/extensions/hash/deck.hash.js"></script>
  <script src="deck.js/extensions/menu/deck.menu.js"></script>
  <script src="deck.js/extensions/goto/deck.goto.js"></script>
  <script src="deck.js/extensions/status/deck.status.js"></script>
  <script src="deck.js/extensions/navigation/deck.navigation.js"></script>
  <script src="deck.js-markdown/deck.markdown.js/Markdown.Converter.js"></script>
  <script src="deck.js-markdown/deck.markdown.js/deck.markdown.js"></script>
  <script src="deck.js/extensions/scale/deck.scale.js"></script>
  <!-- Initialize the deck -->
  <script>
			$(function() {
				$.deck('.slide');
			});
		</script>

</body>
</html>
